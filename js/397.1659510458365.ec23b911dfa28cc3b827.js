(self.webpackChunk_redhat_cloud_services_access_requests_frontend=self.webpackChunk_redhat_cloud_services_access_requests_frontend||[]).push([[397],{17733:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(29439),r=n(92950),l=n.n(r),o=n(56976),c=n(28216),i=n(83215),s=n(45697),u=n.n(s),d=n(24874),m=function(e){var t=e.requestId,n=e.onClose,r=l().useState(!1),s=(0,a.Z)(r,2),u=s[0],m=s[1],p=(0,c.I0)();return l().createElement(o.Modal,{title:"Cancel request?",isOpen:!0,variant:"small",onClose:function(){return n(!1)},actions:[l().createElement(o.Button,{key:"confirm",variant:"danger",onClick:function(){m(!0),d.Z.patch("".concat("/api/rbac/v1","/cross-account-requests/").concat(t,"/"),{status:"cancelled"},{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){if(e.errors&&e.errors.length>0)throw Error(e.errors.map((function(e){return e.detail})).join("\n"));p((0,i.wN)({variant:"success",title:"Request cancelled successfully"})),m(!1),n(!0)})).catch((function(e){p((0,i.wN)({variant:"danger",title:"There was an error cancelling your request",description:e.message})),m(!1),n(!0)}))}},"Yes, cancel"),l().createElement(o.Button,{key:"cancel",variant:"link",onClick:function(){return n(!1)}},"No, keep")]},"Request ",l().createElement("b",null,t)," will be withdrawn.",u&&l().createElement(o.Spinner,{size:"lg"}))};m.propTypes={requestId:u().string,onClose:u().func};const p=m},31643:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var a=n(93433),r=n(29439),l=n(92950),o=n.n(l),c=n(56976),i=n(98975),s=n(8755),u=n(48794),d=n(80164),m=n(38296),p=n(28216),f=n(83215),E=n(45697),v=n.n(E),g=n(24874),h=[],y=[],b=function(e){var t=e.roles,n=e.setRoles,l=void 0===n,E=["Role name","Role description","Permissions"],b=o().useState(Array.from(h)),T=(0,r.Z)(b,2),S=T[0],C=T[1],w=o().useState(y),k=(0,r.Z)(w,2),I=k[0],Z=k[1];o().useEffect((function(){0!==h.length&&0!==y.length||g.Z.get("".concat("/api/rbac/v1","/roles/?limit=9999&order_by=display_name&add_fields=groups_in_count"),{headers:{Accept:"application/json"}}).then((function(e){var t=e.data;t.forEach((function(e){e.isExpanded=!1,e.permissions=e.accessCount})),h=t.map((function(e){return Object.assign({},e)})),C(t);var n=Array.from(t.map((function(e){return e.applications})).flat().reduce((function(e,t){return e.add(t),e}),new Set)).sort();y=n,Z(n)})).catch((function(e){return De((0,f.wN)({variant:"danger",title:"Could not fetch roles list",description:e.message}))}))}),[]);var x=o().useState("name"),_=(0,r.Z)(x,2),D=_[0],q=_[1],P=o().useState("asc"),N=(0,r.Z)(P,2),F=N[0],R=N[1],O=function(e,t,n){q(t),R(n)},A=o().useState(!1),G=(0,r.Z)(A,2),j=G[0],V=G[1],B=o().useState(E[0]),L=(0,r.Z)(B,2),z=L[0],M=L[1],H=o().useState(!1),X=(0,r.Z)(H,2),Y=X[0],Q=X[1],U=o().useState([]),W=(0,r.Z)(U,2),$=W[0],J=W[1],K=o().useState(""),ee=(0,r.Z)(K,2),te=ee[0],ne=ee[1],ae=$.length>0||te,re="filter-application",le="Filter by application",oe=t.map((function(e){return e.display_name})),ce=S.filter((function(e){return!($.length>0)||e.applications.find((function(e){return $.includes(e)}))})).filter((function(e){return e.name.toLowerCase().includes(te)})).filter((function(e){return!l||oe.includes(e.display_name)})),ie=o().useState(1),se=(0,r.Z)(ie,2),ue=se[0],de=se[1],me=o().useState(10),pe=(0,r.Z)(me,2),fe=pe[0],Ee=pe[1],ve=function(e){var t=e.id;return o().createElement(c.Pagination,{itemCount:ce.length,perPage:fe,page:ue,onSetPage:function(e,t){return de(t)},id:"access-requests-roles-table-pagination-"+t,variant:t,onPerPageSelect:function(e,t){de(1),Ee(t)},isCompact:"top"===t})};ve.propTypes={id:v().string};var ge=ce.sort((function(e,t){return"number"==typeof e[D]?"asc"===F?e[D]-t[D]:t[D]-e[D]:"asc"===F?(e[D]+"").localeCompare(t[D]):(t[D]+"").localeCompare(e[D])})).slice((ue-1)*fe,ue*fe),he=o().useState(!1),ye=(0,r.Z)(he,2),be=ye[0],Te=ye[1],Se=t.length>0,Ce=!!Se&&null,we=t.length===ce.length&&t.length>0||Ce,ke=function(e,a,r){var l=ge[r].display_name;n(a?t.concat(l):t.filter((function(e){return e!==l})))},Ie=function(e,t){n(t?ce.map((function(e){return e.display_name})):[])},Ze=o().createElement(c.Button,{variant:"link",onClick:function(){J([]),ne("")}},"Clear filters"),xe=l?null:o().createElement(c.Toolbar,{id:"access-requests-roles-table-toolbar"},o().createElement(c.ToolbarContent,null,o().createElement(c.ToolbarItem,null,o().createElement(c.Dropdown,{onSelect:function(){return Te(!be)},position:"left",toggle:o().createElement(c.DropdownToggle,{splitButtonItems:[o().createElement(c.DropdownToggleCheckbox,{key:"a",id:"example-checkbox-2","aria-label":Se?"Deselect all":"Select all",isChecked:we,onClick:function(){return Ie(0,!Se)}})],onToggle:function(e){return Te(e)},isDisabled:0===S.length},0!==t.length&&o().createElement(o().Fragment,null,t.length," selected")),isOpen:be,dropdownItems:[o().createElement(c.DropdownItem,{key:"0",onClick:function(){return Ie(0,!1)}},"Select none (0 items)"),o().createElement(c.DropdownItem,{key:"1",onClick:function(){return n(t.concat(ge.map((function(e){return e.display_name}))))}},"Select page (",Math.min(ge.length,fe)," items)"),o().createElement(c.DropdownItem,{key:"2",onClick:function(){return Ie(0,!0)}},"Select all (",ce.length," items)")]})),o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.Dropdown,{isOpen:j,onSelect:function(e){V(!1),M(e.target.value),Q(!1)},toggle:o().createElement(c.DropdownToggle,{onToggle:function(e){return V(e)}},o().createElement(s.ZP,null)," ",z),dropdownItems:["Role name","Application"].map((function(e){return o().createElement(c.DropdownItem,{key:e,value:e,component:"button"},(0,d.kC)(e))}))}),"Application"===z?o().createElement(o().Fragment,null,o().createElement("span",{id:re,hidden:!0},le),o().createElement(c.Select,{"aria-labelledby":re,variant:"checkbox","aria-label":"Select applications",onToggle:function(e){return Q(e)},onSelect:function(e,t){$.includes(t)?J($.filter((function(e){return e!==t}))):J([].concat((0,a.Z)($),[t]))},isOpen:Y,selections:$,isCheckboxSelectionBadgeHidden:!0,placeholderText:le,style:{maxHeight:"400px",overflowY:"auto"}},I.map((function(e){return o().createElement(c.SelectOption,{key:e,value:e},(0,d.kC)(e.replace(/-/g," ")))})))):o().createElement(c.TextInput,{name:"rolesSearch",id:"rolesSearch",type:"search",iconVariant:"search","aria-label":"Search input",placeholder:"Filter by role name",value:te,onChange:function(e){return ne(e)}}))),o().createElement(c.ToolbarItem,{variant:"pagination",align:{default:"alignRight"}},o().createElement(ve,{id:"top"}))),ae&&o().createElement(c.ToolbarContent,null,te&&o().createElement(c.ChipGroup,{categoryName:"Role name"},o().createElement(c.Chip,{onClick:function(){return ne("")}},te)),$.length>0&&o().createElement(c.ChipGroup,{categoryName:"Status"},$.map((function(e){return o().createElement(c.Chip,{key:e,onClick:function(){return J($.filter((function(t){return t!==e})))}},e)}))),Ze)),_e=["Application","Resource type","Operation"],De=(0,p.I0)(),qe=o().createElement(i.TableComposable,{"aria-label":"My user access roles",variant:"compact"},o().createElement(i.Thead,null,o().createElement(i.Tr,null,!l&&o().createElement(i.Th,null),o().createElement(i.Th,{width:30,sort:{sortBy:{index:D,direction:F},onSort:O,columnIndex:"name"}},E[0]),o().createElement(i.Th,{width:50,sort:{sortBy:{index:D,direction:F},onSort:O,columnIndex:"description"}},E[1]),o().createElement(i.Th,{width:10,sort:{sortBy:{index:D,direction:F},onSort:O,columnIndex:"permissions"},modifier:"nowrap"},E[2]))),0===S.length&&(0,a.Z)(Array(fe).keys()).map((function(e){return o().createElement(i.Tbody,{key:e},o().createElement(i.Tr,null,!l&&o().createElement(i.Td,null),E.map((function(e,t){return o().createElement(i.Td,{dataLabel:e,key:t},o().createElement("div",{style:{height:"22px"},className:"ins-c-skeleton ins-c-skeleton__md"}," "))}))))})),ge.map((function(e,n){return o().createElement(i.Tbody,{key:n},o().createElement(i.Tr,null,!l&&o().createElement(i.Td,{select:{rowIndex:n,onSelect:ke,isSelected:t.find((function(t){return t===e.display_name}))}}),o().createElement(i.Td,{dataLabel:E[0]},e.display_name),o().createElement(i.Td,{dataLabel:E[1],className:"pf-m-truncate"},o().createElement(c.Tooltip,{entryDelay:1e3,content:e.description},o().createElement("span",{className:"pf-m-truncate pf-c-table__text"},e.description))),o().createElement(i.Td,{dataLabel:E[2],className:(0,m.css)("pf-c-table__compound-expansion-toggle",e.isExpanded&&"pf-m-expanded")},o().createElement("button",{type:"button",className:"pf-c-table__button",onClick:function(){return function(e){e.isExpanded=!e.isExpanded,C((0,a.Z)(S)),e.access||g.Z.get("".concat("/api/rbac/v1","/roles/").concat(e.uuid,"/"),{headers:{Accept:"application/json"}}).then((function(t){e.access=t.access.map((function(e){return e.permission.split(":")})),C((0,a.Z)(S))})).catch((function(t){return De((0,f.wN)({variant:"danger",title:"Could not fetch permission list for ".concat(e.name,"."),description:t.message}))}))}(e)}},e.permissions))),o().createElement(i.Tr,{isExpanded:e.isExpanded,borders:!1},!l&&o().createElement(i.Td,null),o().createElement(i.Td,{className:"pf-u-p-0",colSpan:3},o().createElement(i.TableComposable,{isCompact:!0,className:"pf-m-no-border-rows"},o().createElement(i.Thead,null,o().createElement(i.Tr,null,_e.map((function(e){return o().createElement(i.Th,{key:e},e)})))),o().createElement(i.Tbody,null,Array.isArray(e.access)?e.access.map((function(e){return o().createElement(i.Tr,{key:e.join(":")},o().createElement(i.Td,{dataLabel:_e[0]},e[0]),o().createElement(i.Td,{dataLabel:_e[1]},e[1]),o().createElement(i.Td,{dataLabel:_e[2]},e[2]))})):(0,a.Z)(Array(e.permissions).keys()).map((function(e){return o().createElement(i.Tr,{key:e},_e.map((function(e){return o().createElement(i.Td,{key:e,dataLabel:e},o().createElement("div",{style:{height:"22px"},className:"ins-c-skeleton ins-c-skeleton__sm"}," "))})))})))))))})),0===ge.length&&ae&&o().createElement(i.Tr,null,o().createElement(i.Td,{colSpan:E.length},o().createElement(c.EmptyState,{variant:"small"},o().createElement(c.EmptyStateIcon,{icon:u.ZP}),o().createElement(c.Title,{headingLevel:"h2",size:"lg"},"No matching requests found"),o().createElement(c.EmptyStateBody,null,"No results match the filter criteria. Remove all filters or clear all filters to show results."),Ze))));return o().createElement(o().Fragment,null,!l&&o().createElement(o().Fragment,null,o().createElement(c.Title,{headingLevel:"h2"},"Select roles"),o().createElement("p",null,"Select the roles you would like access to.")),xe,qe,l&&o().createElement(ve,{id:"bottom"}))};b.propTypes={roles:v().any,setRoles:v().any};const T=b},479:(e,t,n)=>{"use strict";n.d(t,{Z:()=>B});var a=n(4942),r=n(29439),l=n(87462),o=n(92950),c=n.n(o),i=n(45697),s=n.n(i),u=n(28216),d=n(83215),m=n(56976),p=n(84564),f=n(86758),E=n(67850),v=n(82120),g=n(41693),h=n(48880),y=n(31643),b=n(64124),T=n(96354),S=n(84213),C=function(e){var t=e.headerContent,n=void 0===t?null:t,a=e.bodyContent,r=void 0===a?null:a,l=e.field,o=void 0===l?"input":l;return c().createElement(m.Popover,{headerContent:n,bodyContent:r},c().createElement("button",{type:"button","aria-label":"More info for ".concat(o),onClick:function(e){return e.preventDefault()},"aria-describedby":"form-name",className:"pf-c-form__group-label-help"},c().createElement(S.ZP,{noVerticalAlign:!0})))};C.propTypes={headerContent:s().element,bodyContent:s().element,field:s().string};const w=C;var k="account-number",I="org-id",Z="start",x="end",_="selected-roles",D=function(e){var t=(0,g.Z)(e).input,n=(0,h.default)().getState().values,a=(0,o.useState)(n[_]||[]),l=(0,r.Z)(a,2),i=l[0],s=l[1];return(0,o.useEffect)((function(){t.onChange(i)}),[i]),c().createElement(m.FormGroup,{fieldId:"select-role"},c().createElement(y.Z,{roles:i,setRoles:s}))};D.propTypes={selectedRoles:s().array,setSelectedRoles:s().func,title:s().string,description:s().string};const q=D;var P=function(){var e,t,n=(0,h.default)().getState().values;return c().createElement(c().Fragment,null,c().createElement(m.Stack,{className:"accessRequests"},c().createElement(m.StackItem,{className:"pf-u-mb-md"},c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4,className:"access-requests-bold-text"},"Account number")),c().createElement(m.GridItem,{sm:12,md:10},c().createElement(m.Text,{component:m.TextVariants.p},n[k])))),c().createElement(m.StackItem,null,c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4,className:"access-requests-bold-text"},"Access duration")))),c().createElement(m.StackItem,null,c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4},"From")),c().createElement(m.GridItem,{sm:12,md:10},c().createElement(m.Text,{component:m.TextVariants.p},n.start)))),c().createElement(m.StackItem,{className:"pf-u-mb-md"},c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4},"To")),c().createElement(m.GridItem,{sm:12,md:10},c().createElement(m.Text,{component:m.TextVariants.p},n.end)))),c().createElement(m.StackItem,null,c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4,className:"access-requests-bold-text"},"Roles")),c().createElement(m.GridItem,{sm:12,md:10},c().createElement(m.Text,{component:m.TextVariants.p},null===(e=n[_])||void 0===e?void 0:e[0])))),null===(t=n[_])||void 0===t?void 0:t.slice(1).map((function(e){return c().createElement(m.StackItem,{key:e},c().createElement(m.Grid,null,c().createElement(m.GridItem,{sm:12,md:2},c().createElement(m.Text,{component:m.TextVariants.h4})),c().createElement(m.GridItem,{sm:12,md:10},c().createElement(m.Text,{component:m.TextVariants.p},e))))}))))};P.propTypes={targetAccount:s().any,start:s().any,end:s().any,roles:s().any,isLoading:s().any,error:s().any,onClose:s().any};const N=P;var F=n(24874);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A="Invalid Account number",G=function(e){return c().createElement(E.ZP,(0,l.Z)({},e,{showFormControls:!1}))},j={"set-name":function(){var e=(0,h.default)().getState,t=c().createElement("p",null,"Customers will be able to see this information as part of your request");return c().createElement(m.Split,{hasGutter:!0},c().createElement(m.SplitItem,{isFilled:!0},c().createElement(m.FormGroup,{label:"First name",name:"first-name",labelIcon:c().createElement(w,{bodyContent:t,field:"first name"})},c().createElement(m.TextInput,{id:"first-name",value:e().values["first-name"],isDisabled:!0}))),c().createElement(m.SplitItem,{isFilled:!0},c().createElement(m.FormGroup,{label:"Last name",name:"last-name",labelIcon:c().createElement(w,{bodyContent:t,field:"last name"})},c().createElement(m.TextInput,{id:"last-name",value:e().values["last-name"],isDisabled:!0}))))},"access-duration":function(){var e=(0,h.default)(),t=e.getState().values,n=c().useState(),a=(0,r.Z)(n,2),l=a[0],o=a[1],i=c().useState(),s=(0,r.Z)(i,2),u=s[0],d=s[1],p=c().useState(),f=(0,r.Z)(p,2),E=f[0],v=f[1],g=new Date;g.setDate(g.getDate()-1);var y=new Date;y.setDate(y.getDate()+60);var b=function(e){return e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})},T=function(e){return/^([0]?[1-9]|[1][0-2])\/([0]?[1-9]|[1|2][0-9]|[3][0|1])\/([0-9]{4})$/.test(e)},S=function(e){var t=e.split("/");if(T(e)){var n=t[0].padStart(2,"0"),a=t[1].padStart(2,"0"),r=t[2].padStart(4,"0");return new Date("".concat(r,"-").concat(n,"-").concat(a,"T00:00:00"))}},C=function(e){if((0,m.isValidDate)(e)){if(e<g){var t="Start date must be today or later";return v(t),t}if(e>y){var n="Start date must be within 60 days of today";return v(n),n}}return v(),""},k=function(e){if(d(),(0,m.isValidDate)(l)){if(l>e){var t="End date must be after start date";return d(t),t}var n=new Date(l);n.setFullYear(n.getFullYear()+1);var a="Access duration may not be longer than one year";return e>n&&d(a),e>n?a:""}return d(),""},I=function(t,n){o(n?new Date(n):void 0),e.change(Z,T(t)?t:""),(0,m.isValidDate)(n)&&!C(n)&&(n.setDate(n.getDate()+7),e.change(x,b(n)),d())},_=function(t,n){k(n)||!T(t)?e.change(x,""):(e.change(x,t),C(l)&&e.change(Z,"")&&v())};return c().createElement(m.FormGroup,{label:"Access duration",isRequired:!0,labelIcon:c().createElement(w,{bodyContent:c().createElement("div",null,"This is the org ID of the account that you would like to receive read access to"),field:"access duration"})},c().createElement(m.Split,{hasGutter:!0},c().createElement(m.SplitItem,null,c().createElement(m.DatePicker,{"aria-label":"Start date",placeholder:"mm/dd/yyyy",value:t.start,dateFormat:b,dateParse:S,onChange:I,validators:[C],inputProps:{onBlur:function(e){var t=e.target.value;return I(t)},validated:""===t.start||t.start&&!T(t.start)?m.ValidatedOptions.error:m.ValidatedOptions.default}}),E||""===t.start?c().createElement(m.HelperText,null,c().createElement(m.HelperTextItem,{variant:"error"},""===t.start?"Enter a valid date ":E)):null),c().createElement(m.SplitItem,{className:"pf-u-mt-sm"},"to"),c().createElement(m.SplitItem,null,c().createElement(m.DatePicker,{"aria-label":"End date",placeholder:"mm/dd/yyyy",value:t.end,dateFormat:b,dateParse:S,onChange:_,validators:[k],inputProps:{onBlur:function(e){var t=e.target.value;return _(t)},validated:""===t.end||t.end&&!T(t.end)?m.ValidatedOptions.error:m.ValidatedOptions.default}}),u||""===t.end?c().createElement(m.HelperText,null,c().createElement(m.HelperTextItem,{variant:"error"},""===t.start?"Enter a valid date ":u)):null)))},"select-roles":q,"review-details":N},V=function(e){var t=e.requestId,n=e.variant,l=e.onClose,i=(0,u.I0)(),s="edit"===n,E=(0,o.useRef)(function(e,t){return{fields:[{component:"wizard",name:"wizard",isDynamic:!0,inModal:!0,showTitles:!0,className:"accessRequests",title:"".concat((0,m.capitalize)(t)," request"),fields:[{name:"details",nextStep:"select-roles",title:"Request details",fields:[{component:"set-name",name:"name",validate:[{type:b.Z.REQUIRED}]},{component:T.Z.TEXT_FIELD,isRequired:!0,label:"Account number",isDisabled:e,placeholder:"Example, 8675309",FormGroupProps:{labelIcon:c().createElement(w,{bodyContent:c().createElement("p",null,"This is the account number that you would like to receive read access to"),field:"account number"})},helperText:"Enter the account number you would like access to",name:k,validate:[{type:"validate-account"}]},{component:T.Z.TEXT_FIELD,isRequired:!0,label:"Organization ID",placeholder:"Example, 1234567",isDisabled:e,FormGroupProps:{labelIcon:c().createElement(w,{bodyContent:c().createElement("p",null,"This is the org ID of the account that you would like to receive read access to"),field:"organization ID"})},helperText:"Enter the organization ID you would like access to",name:I,validate:[{type:"validate-org-id"}]},{name:"access-duration",component:"access-duration",label:"Access duration",isRequired:!0},{name:Z,component:T.Z.TEXT_FIELD,hideField:!0,isRequired:!0,validate:[function(e){return(null==e?void 0:e.length)>0?void 0:"Invalid start date"}]},{name:x,component:T.Z.TEXT_FIELD,hideField:!0,isRequired:!0,validate:[function(e){return(null==e?void 0:e.length)>0?void 0:"Invalid end date"}]}]},{name:"select-roles",nextStep:"review-details",title:"Select roles",StepTemplate:function(e){return e.formFields},fields:[{component:"select-roles",name:_,validate:[function(e){return(null==e?void 0:e.length)>0?void 0:"No roles selected"}]}]},{name:"review-details",title:"Review details",fields:[{component:"review-details",name:"review-details"}]}]}]}}(s,n)),g=(0,o.useState)(!1),h=(0,r.Z)(g,2),y=h[0],S=h[1],C=c().useState(),D=(0,r.Z)(C,2),q=D[0],P=D[1],N=c().useState(),R=(0,r.Z)(N,2),V=R[0],B=R[1],L=c().useState(!1),z=(0,r.Z)(L,2),M=z[0],H=z[1],X=c().useState(!1),Y=(0,r.Z)(X,2),Q=Y[0],U=Y[1],W=c().useState(),$=(0,r.Z)(W,2),J=$[0],K=$[1];c().useEffect((function(){H(!0);var e=insights.chrome.auth.getUser(),n=s?F.Z.get("".concat("/api/rbac/v1","/cross-account-requests/").concat(t,"/?query_by=user_id"),{headers:{Accept:"application/json"}}):new Promise((function(e){return e(!0)}));Promise.all([e,n]).then((function(e){var n=(0,r.Z)(e,2),l=n[0],o=n[1];if(!(l&&l.identity&&l.identity.user))throw Error("Couldn't get current user. Make sure you're logged in");if(K(l.identity.user),s){if(o.errors)throw Error(o.errors.map((function(e){return e.detail})).join("\n"));if(!o||!o.target_account)throw Error("Could not fetch details for request ".concat(t));var c;B((c={},(0,a.Z)(c,k,o.target_account),(0,a.Z)(c,I,o.target_org),(0,a.Z)(c,Z,o.start_date),(0,a.Z)(c,x,o.end_date),(0,a.Z)(c,_,o.roles.map((function(e){return e.display_name}))),c))}H(!1)})).catch((function(e){i((0,d.wN)({variant:"danger",title:"Could not load access request",description:e.message}))}))}),[]);var ee={"validate-account":function(){return function(e){return e&&!q?void 0:"Please enter a valid account number"}},"validate-org-id":function(){return function(e){return e&&!q?void 0:"Please enter a valid organization ID"}},"validate-duration":function(){return function(e){return(null==e?void 0:e.length)>0}}};return y?c().createElement(m.Modal,{title:"Exit request creation?",variant:"small",titleIconVariant:"warning",isOpen:!0,onClose:function(){S(!1),l(!1)},actions:[c().createElement(m.Button,{key:"confirm",variant:"primary",onClick:function(){return l(!1)}},"Exit"),c().createElement(m.Button,{key:"cancel",variant:"link",onClick:function(){return S(!1)}},"Stay")]},"All inputs will be discarded."):q||M||Q?c().createElement(m.Modal,{isOpen:!0,variant:m.ModalVariant.large,showClose:!1,className:"accessRequests",hasNoBodyWrapper:!0,"aria-describedby":"wiz-modal-description","aria-labelledby":"wiz-modal-title"},c().createElement(m.Wizard,{className:"accessRequests",title:"".concat((0,m.capitalize)(n)," request"),steps:[{name:"status",component:M?c().createElement(m.Bullseye,null,c().createElement(m.Spinner,null)):c().createElement(m.EmptyState,null,Q?c().createElement(c().Fragment,null,c().createElement(m.EmptyStateIcon,{icon:function(){return c().createElement(m.Spinner,{size:"lg"})}}),c().createElement(m.Title,{headingLevel:"h2",size:"lg"},"Submitting access request"),c().createElement(m.Button,{variant:"link",onClick:function(){return l(!0)}},"Close")):c().createElement(c().Fragment,null,c().createElement(m.EmptyStateIcon,{icon:p.ZP,color:"#C9190B"}),c().createElement(m.Title,{headingLevel:"h2",size:"lg"},q.title||"An error occured"),c().createElement(m.EmptyStateBody,null,q.description),q.title!==A&&c().createElement(m.Button,{variant:"primary",onClick:function(){return P()}},"Return to Step 1"))),isFinishedStep:!0}],onClose:function(){return l(!0)}})):c().createElement(f.Z,{schema:E.current,subscription:{values:!0},FormTemplate:G,componentMapper:O(O({},v.ZP),j),validatorMapper:ee,onSubmit:function(e){U(!0);var a={target_account:e[k],start_date:e.start,end_date:e.end,target_org:e[I],roles:e[_]};B(e),F.Z[s?"put":"post"]("".concat("/api/rbac/v1","/cross-account-requests/").concat(s?"/".concat(t,"/"):""),a,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){if(e.errors&&e.errors.length>0)throw Error(e.errors[0].detail);i((0,d.wN)({variant:"success",title:"".concat(s?"Edited":"Created"," access request"),description:e.request_id})),l(!0)})).catch((function(e){var t,a,r,l,o=e.errors,c=void 0===o?[]:o,i=/Account .* does not exist/.test((null===(t=c[0])||void 0===t?void 0:t.message)||(null===(a=c[0])||void 0===a?void 0:a.detail));P({title:i?A:"Could not ".concat(n," access request"),description:i?"Please return to Step 1: Request details and input a new account number for your request.":(null===(r=c[0])||void 0===r?void 0:r.message)||(null===(l=c[0])||void 0===l?void 0:l.detail)}),U(!1)}))},initialValues:O(O({},V),{},{"first-name":null==J?void 0:J.first_name,"last-name":null==J?void 0:J.last_name}),onCancel:function(){return S(!0)}})};V.propTypes={requestId:s().string,variant:s().any,onClose:s().func};const B=V},24874:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(96992),r=n.n(a),l=n(33366),o=n(1140),c=n(85118),i=r().create();i.interceptors.request.use(l.w5),i.interceptors.response.use(l.xH),i.interceptors.response.use(null,l.Di),i.interceptors.response.use(null,(function(e){var t=o.Z.getStore();throw e.response&&403===e.response.status&&t.dispatch({type:c.j,payload:403}),e})),i.interceptors.response.use(null,l.ub),i.interceptors.response.use(null,l.ud);const s=i},42027:(e,t,n)=>{"use strict";n.d(t,{m:()=>E,p:()=>v});var a=n(29439),r=n(92950),l=n.n(r),o=n(56976),c=n(28216),i=n(83215),s=n(76710),u=n(4145),d=n(80164),m=n(45697),p=n.n(m),f=n(24874);function E(e,t,n){var a=[];return"pending"===e&&(a.push({title:"Edit",onClick:function(){return n({type:"edit",requestId:t})}}),a.push({title:"Cancel",onClick:function(){return n({type:"cancel",requestId:t})}})),{items:a,disable:0===a.length}}function v(e){var t=e.requestId,n=e.status,r=e.hideActions,m=l().useState(n),p=(0,a.Z)(m,2),E=p[0],v=p[1],g=l().useState(!1),h=(0,a.Z)(g,2),y=h[0],b=h[1],T=l().useState(!1),S=(0,a.Z)(T,2),C=S[0],w=S[1],k=(0,c.I0)();function I(e){w(!0),f.Z.patch("".concat("/api/rbac/v1","/cross-account-requests/").concat(t,"/"),{status:e},{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){if(t.errors&&t.errors.length>0)throw Error(t.errors.map((function(e){return e.detail})).join("\n"));k((0,i.wN)({variant:"success",title:"Request ".concat(e," successfully")})),v(e),b(!1),w(!1)})).catch((function(t){k((0,i.wN)({variant:"danger",title:"There was an error ".concat("approved"===e?"approving":"denying"," your request"),description:t.message})),w(!1)}))}var Z=l().createElement(o.Label,(0,s.Q)(E),(0,d.kC)(E));return r?Z:l().createElement(l().Fragment,null,y||"pending"===E?l().createElement(l().Fragment,null,l().createElement(o.Button,{className:"pf-u-mr-md",isDisabled:C||"approved"===E,variant:"primary",onClick:function(){return I("approved")}},"Approve"),l().createElement(o.Button,{className:"pf-u-mr-md",isDisabled:C||"denied"===E,variant:"danger",onClick:function(){return I("denied")}},"Deny")):Z,["approved","denied"].includes(E)&&l().createElement(o.Button,{variant:"plain","aria-label":"Edit status",onClick:function(){return b(!y)}},l().createElement(u.ZP,null)))}v.propTypes={requestId:p().string,status:p().any,hideActions:p().any}},76710:(e,t,n)=>{"use strict";n.d(t,{Q:()=>u});var a=n(92950),r=n.n(a),l=n(35451),o=n(84564),c=n(3235),i=n(18802),s=n(75427);function u(e){var t=null,n=null;return"pending"===e?(t="blue",n=r().createElement(i.ZP,null)):"approved"===e?(t="green",n=r().createElement(l.ZP,null)):"denied"===e?(t="red",n=r().createElement(o.ZP,null)):"cancelled"===e?(t="orange",n=r().createElement(c.ZP,null)):"expired"===e&&(t="grey",n=r().createElement(s.ZP,null)),{color:t,icon:n}}},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{},70347:()=>{},11452:()=>{},10497:()=>{},32857:()=>{},93818:()=>{},94498:()=>{},54476:()=>{},28992:()=>{},40837:()=>{},90479:()=>{},78752:()=>{},74282:()=>{},25238:()=>{},91993:()=>{},99624:()=>{},36974:()=>{},27479:()=>{},93661:()=>{},56024:()=>{},43390:()=>{},40209:()=>{},87234:()=>{},38299:()=>{},72816:()=>{}}]);
//# sourceMappingURL=../sourcemaps/397.5d486fe2170bfc614e273f9b648b3f17.js.map